<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>2/3D Semantic Segmentation of Skin H&amp;E Tissue Images | Kevin (Won June) Cho</title> <meta name="author" content="Kevin (Won June) Cho"> <meta name="description" content="Segmentation of Skin H&amp;E Tissue Images to Analyze Novel Cellular Biomarkers of Aging"> <meta name="keywords" content="deep-learning, image-segmentation, python, pytorch"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://chokevin8.github.io/projects/2_project/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Kevin (Won June) Cho</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About Me</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">My Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">My Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">My Github</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">My Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">2/3D Semantic Segmentation of Skin H&amp;E Tissue Images</h1> <p class="post-description">Segmentation of Skin H&amp;E Tissue Images to Analyze Novel Cellular Biomarkers of Aging</p> <p class="post-moredescription"><i>Master's Thesis Project (2023 ~ Present)</i></p> </header> <article> <hr> <h3 id="project-motivation--background"><strong>Project Motivation &amp; Background:</strong></h3> <p><br></p> <p><strong>Let’s play a simple guessing game: Look at the pictures below. Can you guess who is older?</strong></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/real_95yr_man-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/real_95yr_man-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/real_95yr_man-1400.webp"></source> <img src="/assets/img/2_project/real_95yr_man.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="95 Year Old Man" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/Tom_Brady_44yr_old-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/Tom_Brady_44yr_old-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/Tom_Brady_44yr_old-1400.webp"></source> <img src="/assets/img/2_project/Tom_Brady_44yr_old.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="44 Year Old Tom Brady" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> On the left, we have a 95 year old man, and on the right, we have 44 year old Tom Brady. </div> <p><em>Pretty obvious, right?</em> The man on the left is older and the man on the right (Tom Brady, if you didn’t recognize him) is younger. Now, assume we were able to receive the skin tissue samples of both men, cut them into serial sections, applied H&amp;E stain to them, scanned/digitized them, and then looked at one part of the whole slide images (WSI). Two pairs of pictures at different magnifications (4x and 20x) are shown below, and each man’s H&amp;E image pairs are either on the left or the right. <strong><em>Can you answer the same question now?</em></strong></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/44yr_4x.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/44yr_4x.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/44yr_4x.PNG-1400.webp"></source> <img src="/assets/img/2_project/44yr_4x.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="44yr_4x" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/95yr_4x.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/95yr_4x.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/95yr_4x.PNG-1400.webp"></source> <img src="/assets/img/2_project/95yr_4x.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="95yr_4x" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/44yr_20x.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/44yr_20x.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/44yr_20x.PNG-1400.webp"></source> <img src="/assets/img/2_project/44yr_20x.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="44yr_20x" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/95yr_20x.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/95yr_20x.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/95yr_20x.PNG-1400.webp"></source> <img src="/assets/img/2_project/95yr_20x.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="95yr_20x" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Which tissue belongs to the 95-year old man? The image pair on the left or the right? </div> <p>The answer is: <strong><em>44-year old Tom Brady is on the left, and 95-year old man is on the right.</em></strong> While these tissues are not actually from the people pictured above, they actually are tissue samples from patients who are 44 years old and 95 years old. How can we tell? The picture in the first row actually shows that there are more oil glands in the left than the right, and the second row shows more ECM alignment. However, without this previous knowledge, <em>the point is, compared to just looking at someone’s face, it’s much harder to determine a person’s age by just looking at their skin H&amp;E tissue sample.</em> But someone may ask, <strong><em>why do we want to do this? Why study aging, specifically in skin H&amp;E tissue samples?</em></strong></p> <p>It’s a well-known fact that old age is correlated with virtually every disease that are the leading causes of death- heart disease, cancer, stroke, Alzheimer’s, and recently, COVID-19. To help facilitate possible interventions to prevent these chronic age-related diseases, it is critical to develop methods to accurately calculate one’s biological age. And as we’ve seen above, the easiest way of telling the approximate age of someone is to look at their face, or <em>skin</em>. Therefore, this study aims to find features related to aging in the skin, and like any other organs, skin function also deteriorates with age. For example, as we age, the skin loses its structural integrity and self-renewal capabilities, and experiences increased inflammation and poor temperature regulation. Look at the below diagram:</p> <div class="row"> <div class="col-sm"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/skin_background-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/skin_background-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/skin_background-1400.webp"></source> <img src="/assets/img/2_project/skin_background.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Skin Background" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Diagram comparing major differences between young and old skin. Diagram from <i>Orioli et al (Cells 2018) Epigenetic Regulation of Skin Cells in Natural Aging and Premature Aging Diseases</i>. </div> <p>As seen in the above diagram, we already know the major differences between young and old skin. However, there has been lack of research done in the biomarkers of aging at a <strong><em>cellular level</em></strong>. <a href="https://www.nature.com/articles/s41551-017-0093" rel="external nofollow noopener" target="_blank">Previous research</a> in our lab has revealed biomolecular and biophysical biomarkers at the cellular level by analyzing primary dermal fibroblasts. The purpose of this study is to extend the results of this study in finding <strong><em>specific morphological biomarkers correlated with aging by utilizing skin H&amp;E images to shed more light in the biological aging process.</em></strong></p> <hr> <h3 id="methods"><strong>Methods:</strong></h3> <div class="row"> <div class="col-sm"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2_project/methods-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2_project/methods-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2_project/methods-1400.webp"></source> <img src="/assets/img/2_project/methods.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Methods" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Simplified diagram showing overall methods of this project. </div> <p>As seen in above diagram, we first obtain skin tissue samples, cut them into serial sections, apply H&amp;E stain, and scan and digitize each slide to obtain a z-stack of 2D WSIs. Then, we undergo image registration to registrate all of the z-stack together and divide the images into a train-val-test split.</p> <p>We train two different models: 1) Nuclei segmentation model using <a href="https://arxiv.org/pdf/1812.06499v5.pdf" rel="external nofollow noopener" target="_blank">HoVer-Net</a> and 2) Tissue segmentation model using <a href="https://arxiv.org/pdf/1802.02611.pdf" rel="external nofollow noopener" target="_blank">DeepLabV3+</a> and/or <a href="https://arxiv.org/abs/1807.10165" rel="external nofollow noopener" target="_blank">UNet++</a>. In order to train these supervised models, we manually annotate the nuclei or the twelve different tissue classes in the training and validation images. I hypothesized DeepLabV3+ to be a more lightweight model due to its ASPP (atrous spatial pyramid pooling) module and depthwise separable convolution, while Unet++ to be a more heavyweight but accurate model due to its dense skip connections. However, both models had negligible differences in their F-1 scores on the validation set.</p> <p>Then, after confirming the model performance using overall precision and recall (F1 score) on the test dataset, we use a post-processing pipeline to extract different meaningful 2D features. Some example features to extract are individual tissue compositions and its area, distance between different cells and tissues (ex. distance between fibroblast and sweat glands), and more.</p> <hr> <h3 id="results"><strong>Results:</strong></h3> <p><strong><em>Since this is currently a work-in-progress, updates will be made whenever possible.</em></strong></p> <p>In total, 1090 2D features were extracted. Out of the 1090 features, through statistical testing with univariate analyses (multivariate analyses will be done in the future as well) and correlation coefficient calculations, features that were most predictive and correlated with age were selected. Additionally, gender differences and body part differences (skin from different body parts) will also be analyzed. Currently, the results are being finalized and I plan to update this soon.</p> <p><strong><em>Note that more technical details/explanations and further results are omitted on purpose as I focus on motivation/personal comments in introducing the project. More technical details will be shown in the technical powerpoint presentation (PPT).</em></strong></p> <hr> <h3 id="personal-comments"><strong>Personal Comments:</strong></h3> <h3 id="q-why-did-i-choose-this-project">Q: Why did I choose this project?</h3> <p>This is a fascinating project to me because it necessitates both biology and deep-learning background. I was originally planning to continue my research about <a href="/projects/3_project/">gene delivery for immunoengineering</a>, but my interests in different types of computational work grew more after my <a href="/projects/4_project/">summer internship experience at Novartis</a>. As I switched my research interests to computational work, I was initially worried because I still wanted to continue cancer research in one way or another. Also, I wanted experience in handling different types of biological/medical data. Therefore, while this project is not directly related to cancer, the project was a perfect choice because the pipeline could easily be applicable to cancer (just switch the H&amp;E WSIs to tumor WSIs and find new ways of developing digital biomarkers for cancer instead), and handled image data, which I never had prior experience with. Therefore, since August of 2022, I switched labs and have been working on this project.</p> <h3 id="q-what-did-i-do-outside-of-this-project">Q: What did I do outside of this project?</h3> <p> Since I didn't have any significant prior knowledge in the field of dermatology, histopathology, or deep learning before starting this as my Master's Thesis project, this is a fun but challenging project for me. To make up for my lack of knowledge, I always strive to do more background article reading to learn about the computational pathology space. There are a plethora of different subfields within computational pathology that interest me- for example, we can utilize various models like CNNs or ViTs for image registration, segmentation, and even translation/generation for not only H&amp;E stained images, but also for different types of stains frequently utilized such as IHC stains. In addition, since I'm not a computer science major, I also try to continue to learn more about Python/PyTorch and probabilistic machine/deep learning everyday by taking relevant courses in school or reading online articles/textbooks. </p> <h3 id="q-what-impact-did-this-project-have-on-me">Q: What impact did this project have on me?</h3> <p>This project has and will be an important turning point of my career in developing myself as an interdisciplinary scientist that is able to utilize biology/medical data and extract meaningful features out of them.</p> <hr> <p><em>Image credits to:</em></p> <ul> <li><a href="https://www.gq.com/story/how-does-a-95-year-old-runner-stay-in-shape" rel="external nofollow noopener" target="_blank">95 Year Old Man</a></li> <li><a href="https://en.wikipedia.org/wiki/Tom_Brady" rel="external nofollow noopener" target="_blank">Tom Brady</a></li> <li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6315602/" rel="external nofollow noopener" target="_blank">Young and Old Skin Comparison Diagram</a></li> </ul> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Kevin (Won June) Cho. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>